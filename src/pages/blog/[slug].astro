---
import { getCollection } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';
import CTABanner from '../../components/common/CTABanner.astro';

export async function getStaticPaths() {
  const blogEntries = await getCollection('blog');
  return blogEntries.map(entry => ({
    params: { slug: entry.slug },
    props: { entry },
  }));
}

const { entry } = Astro.props;
const { Content } = await entry.render();

const formattedDate = entry.data.publishedAt.toLocaleDateString('ko-KR', {
  year: 'numeric',
  month: 'long',
  day: 'numeric',
});
---
<BaseLayout title={`${entry.data.title} | 유통스타트 블로그`} description={entry.data.description}>
  <article class="bg-white overflow-hidden">
    <!-- Hero Image for Detail -->
    <div class="h-[40vh] md:h-[50vh] w-full relative">
      <img src={entry.data.thumbnail} alt={entry.data.title} class="w-full h-full object-cover" />
      <div class="absolute inset-0 bg-gradient-to-t from-primary-950 via-primary-950/40 to-transparent"></div>
      <div class="absolute bottom-12 left-0 w-full">
        <div class="max-w-3xl mx-auto px-4 text-white animate-fade-in-up">
           <span class="inline-block bg-accent-500 text-white px-4 py-1 rounded-full text-xs font-bold mb-6">
            {entry.data.category}
          </span>
          <h1 class="text-3xl md:text-5xl font-black leading-tight tracking-tight drop-shadow-md">
            {entry.data.title}
          </h1>
          <div class="mt-8 flex items-center gap-4 text-primary-200">
            <div class="w-10 h-10 rounded-full bg-primary-800 border-2 border-primary-700 flex items-center justify-center font-bold text-sm">U</div>
            <div class="text-sm">
              <p class="font-bold text-white">{entry.data.author}</p>
              <p class="opacity-70">{formattedDate}</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="py-16 md:py-24">
      <div class="max-w-3xl mx-auto px-4">
        <div class="prose prose-lg md:prose-xl mx-auto prose-primary 
          prose-headings:text-primary-950 prose-headings:font-bold prose-headings:tracking-tight 
          prose-p:text-neutral-700 prose-p:leading-relaxed 
          prose-li:text-neutral-700 
          prose-img:rounded-3xl prose-img:shadow-2xl
          prose-blockquote:italic prose-blockquote:text-primary-900 prose-blockquote:font-medium prose-blockquote:border-l-accent-500
          prose-strong:text-primary-950 prose-strong:font-black
          prose-a:text-accent-500 hover:prose-a:text-accent-600 transition-colors
          animate-fade-in-up" 
          style="animation-delay: 200ms;"
        >
          <Content />
        </div>
        
        <div class="mt-16 pt-10 border-t border-neutral-100 flex flex-wrap gap-3 animate-fade-in-up" style="animation-delay: 300ms;">
          {entry.data.tags.map(tag => (
            <span class="bg-neutral-50 text-neutral-500 border border-neutral-200 px-4 py-1.5 rounded-full text-sm font-bold hover:bg-neutral-100 hover:text-primary-600 transition-all cursor-pointer">
              #{tag}
            </span>
          ))}
        </div>
      </div>
    </div>
  </article>
  
  <!-- 추천 블로그 포스트 유도 (옵션) -->
  
  <CTABanner />
</BaseLayout>

<style>
  .animate-fade-in-up {
    animation: fadeInUp 1s cubic-bezier(0.16, 1, 0.3, 1) forwards;
    opacity: 0;
    transform: translateY(30px);
  }
  @keyframes fadeInUp {
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
</style>
